const burgerData = [
  {
    id: "b1",
    title: "Royal Cheese Burger with extra Fries",
    description: "1 McChicken™, 1 Big Mac™, 1 Royal Cheeseburger™, 3 medium",
    price: "GBP 23.10",
    image: "./images/cardImage.png",
  },
  {
    id: "b2",
    title: "Double Beef Burger",
    description: "2 Patties, Cheddar, Lettuce, Tomato, Fries",
    price: "GBP 19.90",
    image: "./images/cardImage.png",
  },
  {
    id: "b3",
    title: "Chicken Supreme Combo",
    description: "1 Chicken Supreme, 1 Fries, 1 Drink",
    price: "GBP 17.50",
    image: "./images/cardImage.png",
  },
  {
    id: "b4",
    title: "Chicken Supreme Combo",
    description: "1 Chicken Supreme, 1 Fries, 1 Drink",
    price: "GBP 17.50",
    image: "./images/cardImage.png",
  },
  {
    id: "b5",
    title: "Chicken Supreme Combo",
    description: "1 Chicken Supreme, 1 Fries, 1 Drink",
    price: "GBP 17.50",
    image: "./images/cardImage.png",
  },
  {
    id: "b6",
    title: "Chicken Supreme Combo",
    description: "1 Chicken Supreme, 1 Fries, 1 Drink",
    price: "GBP 17.50",
    image: "./images/cardImage.png",
  },
];

const friesData = [
  {
    id: "f1",
    title: "Royal Cheese Burger with extra Fries",
    description: "1 McChicken™, 1 Big Mac™, 1 Royal Cheeseburger™, 3 medium",
    price: "GBP 23.10",
    image: "./images/fries.png",
  },
  {
    id: "f2",
    title: "Double Beef Burger",
    description: "2 Patties, Cheddar, Lettuce, Tomato, Fries",
    price: "GBP 19.90",
    image: "./images/fries.png",
  },
  {
    id: "f3",
    title: "Chicken Supreme Combo",
    description: "1 Chicken Supreme, 1 Fries, 1 Drink",
    price: "GBP 17.50",
    image: "./images/fries.png",
  },
  {
    id: "f4",
    title: "Chicken Supreme Combo",
    description: "1 Chicken Supreme, 1 Fries, 1 Drink",
    price: "GBP 17.50",
    image: "./images/fries.png",
  },
  {
    id: "f5",
    title: "Chicken Supreme Combo",
    description: "1 Chicken Supreme, 1 Fries, 1 Drink",
    price: "GBP 17.50",
    image: "./images/fries.png",
  },
  {
    id: "f6",
    title: "Chicken Supreme Combo",
    description: "1 Chicken Supreme, 1 Fries, 1 Drink",
    price: "GBP 17.50",
    image: "./images/fries.png",
  },
];

const drinksData = [
  {
    id: "d1",
    title: "Royal Cheese Burger with extra Fries",
    description: "1 McChicken™, 1 Big Mac™, 1 Royal Cheeseburger™, 3 medium",
    price: "GBP 23.10",
    image: "./images/img1.png",
  },
  {
    id: "d2",
    title: "The classics for 3",
    description:
      "1 McChicken™, 1 Big Mac™, 1 Royal Cheeseburger™, 3 medium sized French Fries, 3 cold drinks",
    price: "GBP 23.10",
    image: "/images/img2.png",
  },
  {
    id: "d3",
    title: "The classics for 3",
    description:
      "1 McChicken™, 1 Big Mac™, 1 Royal Cheeseburger™, 3 medium sized French Fries, 3 cold drinks",
    price: "GBP 23.10",
    image: "/images/img3.png",
  },
  {
    id: "d4",
    title: "The classics for 3",
    description:
      "1 McChicken™, 1 Big Mac™, 1 Royal Cheeseburger™, 3 medium sized French Fries, 3 cold drinks",
    price: "GBP 23.10",
    image: "/images/img4.png",
  },
  {
    id: "d5",
    title: "The classics for 3",
    description:
      "1 McChicken™, 1 Big Mac™, 1 Royal Cheeseburger™, 3 medium sized French Fries, 3 cold drinks",
    price: "GBP 23.10",
    image: "/images/img5.png",
  },
  {
    id: "d6",
    title: "The classics for 3",
    description:
      "1 McChicken™, 1 Big Mac™, 1 Royal Cheeseburger™, 3 medium sized French Fries, 3 cold drinks",
    price: "GBP 23.10",
    image: "/images/img6.png",
  },
];
const reviews = [
  {
    name: "Stasd",
    location: "South London",
    date: "24th September, 2023",
    rating: 5, // number of stars (5 stars here)
    review:
      "The positive aspect was undoubtedly the efficiency of the service. The queue moved quickly, the staff was friendly, and the food was up to the usual McDonald's standard – hot and satisfying.",
    image: "./images/reviewImg.png", // You can add image URL if you want to show avatar dynamically
  },
  {
    name: "St asd",
    location: "South London",
    date: "24th September, 2023",
    rating: 5,
    review:
      "The positivedsas undoubtedly the efficiency of the service. The queue moved quickly, the staff was friendly, and the food was up to the usual McDonald's standard – hot and satisfying.",
    image: "./images/reviewImg.png",
  },
  {
    name: "St da",
    location: "South London",
    date: "24th September, 2023",
    rating: 5,
    review:
      "Thdatedly the efficiency of the service. The queue moved quickly, the staff was friendly, and the food was up to the usual McDonald's standard – hot and satisfying.",
    image: "./images/reviewImg.png",
  },
  {
    name: "Stsd",
    location: "South London",
    date: "24th September, 2023",
    rating: 5,
    review:
      "The positidsaiency of the service. The queue moved quickly, the staff was friendly, and the food was up to the usual McDonald's standard – hot and satisfying.",
    image: "./images/reviewImg.png",
  },
  {
    name: "St asd",
    location: "South London",
    date: "24th September, 2023",
    rating: 5,
    review: "The positivdsa satisfying.",
    image: "./images/reviewImg.png",
  },
];

function mapFunction(menuItem, id) {
  let container = document.getElementById(id);
  menuItem.map((item) => {
    let card = document.createElement("div");
    card.className =
      "card flex flex-col sm:flex-row rounded-xl bg-white shadow-2xl py-4 px-5 space-y-4 sm:space-y-0 sm:space-x-4";
    card.innerHTML = `
       <div class="cardContent flex-1">
          <h3 class="font-bold text-[15px]">${item.title}</h3>
          <p class="text-[10px] leading-4 my-3">
           ${item.description}
          </p>
          <h3 class="font-bold">${item.price}</h3>
        </div>
        <div class="cardImage relative w-full sm:w-[120px] flex-shrink-0">
          <img class="w-[200px] h-full object-cover rounded-md" src=${item.image} alt="Image">
          <div onclick=addToCart('${item.id}') class="plusIcon cursor-pointer bg-white ">
            <img class="absolute bottom-0 right-0" src="./images/Plus.png" alt="">
          </div>
        </div>
    `;
    container.appendChild(card);
  });
}

let itemsQuantities = {};
let array = [];

function increaseQuantity(id) {
  if (!itemsQuantities[id]) {
    itemsQuantities[id] = 1;
  } else {
    itemsQuantities[id] += 1;
  }
  renderCartItem();
  calculateTotalBill();
  console.log("array", array);
}

function decreaseQuantity(id) {
  if (itemsQuantities[id] && itemsQuantities[id] > 0) {
    itemsQuantities[id] -= 1;

    // Optionally remove item from cart if quantity is 0
    if (itemsQuantities[id] === 0) {
      array = array.filter((item) => item.id !== id);
    }

    renderCartItem();
    calculateTotalBill();
  }
}

function addToCart(id) {
  const allItems = [...burgerData, ...friesData, ...drinksData];
  const selectedItem = allItems.find((item) => item.id === id);

  // let quantity = 0;

  if (!selectedItem) {
    alert("Item not found!");
    return;
  }

  if (!array.find((item) => item.id === id)) {
    array.push(selectedItem);
  }

  if (!itemsQuantities[id]) {
    itemsQuantities[id] = 1;
  } else {
    itemsQuantities[id] += 1;
  }
  renderCartItem();
  updateTotalItems();
  console.log("array", array);
  calculateTotalBill();
  console.log("selectedItem.title", selectedItem.title);
}

function renderCartItem() {
  let container = document.getElementById("cartContent");
  container.innerHTML = ""; // Clear old content

 let itemHTML = '';

array.map((item) => {
  let quantity = itemsQuantities[item.id] || 0;
  itemHTML += `
    <div class="flex items-center justify-between bg-[rgba(217,217,217,0.6)] rounded px-4 py-3 mb-3">
      <div class="flex items-center space-x-4">
        <img src="${item.image}" alt="${item.title}" class="w-10 h-10 object-cover rounded-full " />
        <h3 class="font-bold text-[rgba(3,8,31,1)]">${item.title}</h3>
      </div>
      <div class="flex items-center space-x-2">
        <button onclick="decreaseQuantity('${item.id}')" class="flex cursor-pointer items-center justify-center rounded-full text-black text-lg font-bold">
          <img src="./images/minusBtn.png" alt="-" class="w-7 object-cover rounded-full " />
        </button>
        <span class="w-8 text-center bg-white px-2 py-3 rounded font-semibold">${quantity}</span>
        <button onclick="increaseQuantity('${item.id}')" class="flex cursor-pointer items-center justify-center rounded-full text-black text-lg font-bold">
          <img src="./images/plusBtn.png" alt="+" class="w-7 object-cover rounded-full " />
        </button>
      </div>
    </div>
  `;
});

itemHTML += `
  <div class="flex mt-6 justify-between items-center">
    <button class="bg-[#FC8A06] bg-opacity-80 text-white py-1 px-4 rounded flex items-center gap-2">
      <span class="text-xs flex flex-row">Total to Pay</span>
      <span class="font-bold text--[8px]" id="totalAmount">£127.90</span>
    </button>
    <p class="text-[10px] text-gray-600 ml-4">Delivery & Tax will be calculated in the next step</p>
  </div>
  <div class="flex mt-6 justify-end gap-4">
    <button class="text-sm text-black font-semibold underline">Take me back</button>
    <button class="bg-[rgba(2,134,67,1)] text-white py-2 px-5 rounded text-sm flex gap-2 font-medium">
      <span><img class="w-6" src="./images/cartBtnArrow.png" alt=""></span>Next Step
    </button>
  </div>
`;


    container.innerHTML += itemHTML;
  // });
}
mapFunction(burgerData, "cardContainer");
mapFunction(friesData, "friesContainer");
// mapFunction(drinksData, "coldDrinkContainer");
mapFunction(drinksData, "coldDrinkContainer");
mapFunction(reviews, "reviews-container");

function updateTotalItems() {
  const totalItems = Object.values(itemsQuantities).reduce((a, b) => a + b, 0);
  document.getElementById("itemsQuantity").innerHTML = totalItems;
}

const reviewsContainer = document.getElementById("reviews-container");
const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");

let startIndex = 0;
const visibleCards = 3;

// Render reviews
function renderReviews() {
  reviewsContainer.innerHTML = "";

  const visibleReviews = reviews.slice(startIndex, startIndex + visibleCards);

  visibleReviews.forEach((review) => {
    const card = document.createElement("div");
    card.className = "bg-white p-4 md:p-6 shadow rounded w-full mx-auto";

    card.innerHTML = `
  <div class="flex flex-col sm:flex-row sm:items-center mb-4 gap-4">
    <!-- Profile image and info -->
    <div class="flex items-center space-x-4">
      <img src="${review.image}" alt="${review.name}" 
           class="w-10 h-10 rounded-full object-cover" />
      <div class="border-l-4 border-orange-500 h-16"></div>
      <div class="flex flex-col">
        <h4 class="font-bold text-base sm:text-lg text-black">${
          review.name
        }</h4>
        <p class="text-orange-500 text-sm">${review.location}</p>
      </div>
    </div>

    <!-- Spacer - only on larger screens -->
    <div class="hidden sm:block flex-1"></div>

    <!-- Date and stars -->
    <div class="flex flex-col sm:items-end gap-2">
      <!-- Stars -->
      <div class="rounded px-2 py-0.5 text-orange-500 font-semibold select-none">
        ${"★".repeat(review.rating)}${"☆".repeat(5 - review.rating)}
      </div>
      
      <!-- Date with clock icon -->
      <p class="text-black flex gap-1 text-sm items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-orange-500" fill="none" viewBox="0 0 24 24"
          stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6l4 2" />
          <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2" fill="none" />
        </svg>
        ${review.date}
      </p>
    </div>
  </div>

  <p class="text-black text-sm sm:text-base leading-relaxed">
    ${review.review}
  </p>
`;

    reviewsContainer.appendChild(card);
  });

  // Disable buttons conditionally
  prevBtn.disabled = startIndex === 0;
  nextBtn.disabled = startIndex + visibleCards >= reviews.length;
  prevBtn.classList.toggle("opacity-50", prevBtn.disabled);
  nextBtn.classList.toggle("opacity-50", nextBtn.disabled);
}

// Button Events
prevBtn.addEventListener("click", () => {
  if (startIndex > 0) {
    startIndex--;
    renderReviews();
  }
});

nextBtn.addEventListener("click", () => {
  if (startIndex + visibleCards < reviews.length) {
    startIndex++;
    renderReviews();
  }
});

// Initial render
renderReviews();

function calculateTotalBill() {
  let total = 0;

  array.forEach((item) => {
    const quantity = itemsQuantities[item.id] || 0;
    const priceString = item.price.replace("GBP", "").trim(); // remove "GBP"
    const price = parseFloat(priceString); // convert to number

    if (!isNaN(price)) {
      total += price * quantity;
    }
  });

  // Update the total amount on the page
  const totalAmountElement = document.getElementById("totalAmount");
  if (totalAmountElement) {
    totalAmountElement.textContent = `£${total.toFixed(2)}`;
  }
}
